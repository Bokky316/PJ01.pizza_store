<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>회원 정보 추가 및 로컬스토리지 저장</title>
    <link rel="stylesheet" href="./css/join.css" />
    <link rel="stylesheet" href="./css/style.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="./javascript/jquery-1.12.3.js" defer type="text/javascript"></script>
    <script src="./javascript/script.js" defer type="text/javascript"></script>
    <script src="./javascript/admin.js"></script>
</head>
<body>
    <header>
      <div class="top">
        <div class="logo">
          <a href="index.html"><img src="images/logo.png" alt="로고"></a>
        </div>
        <div id="menu_bg"></div>   <!--서브메뉴 배경-->
        <nav class="menu">
          <div class="util_nav"> <!-- 로그인, 회원가입 / 관리자 (href=""에 연결시켜주기) -->
            <a href="login.html" title="로그인" id="loginLink">로그인</a> <!-- 로그인 페이지 연결 -->
            <a href="join.html" title="회원가입" id="signupLink">회원가입</a> <!-- 회원가입 페이지 연결 -->
            <a href="admin.html" title="관리자" id="adminLink" style="display: none">관리자</a> <!-- 관리자 페이지 연결 -->
            <a href="#" title="로그아웃" id="logoutLink" style="display: none">로그아웃</a>
            <a href="cart.html" title="장바구니" id="cartLink" style="display: none;">장바구니</a>
            <span id="welcomeMessage" style="display: none;"></span>
          </div>              
          <ul class="navi">
            <li><a href="1.menulist.html">메뉴</a> <!-- 상품페이지랑 연결 -->
              <ul class="submenu">
                <li><a href="1.menulist.html">피자</a></li>
                <li><a href="#">하프앤하프</a></li>
                <li><a href="#">사이드디시</a></li>
                <li><a href="#">인기세트메뉴</a></li>
                <li><a href="#">마이키친</a></li>
                <li><a href="#">음료&기타</a></li>
              </ul>
            </li>
            <li><a href="#">e-쿠폰</a>
              <ul class="submenu">
                <li><a href="#">e-쿠폰 주문</a></li>
                <li><a href="#">e-쿠폰 사용 안내</a></li>
              </ul>
            </li>
            <li><a href="#">상품권 선물</a>
              <ul class="submenu">
                <li><a href="#">모바일상품권(도미노콘)</a></li>
                <li><a href="#">금액상품권</a></li>
                <li><a href="#">지류상품권</a></li>
                <li><a href="#">상품권 사용 안내</a></li>
              </ul>
            </li>
            <li><a href="#">이벤트/제휴</a> 
              <ul class="submenu">
                <li><a href="#">이벤트</a></li>
                <li><a href="#">제휴할인</a></li>
              </ul>
            </li>          
            <li><a href="boardList.html?categoryId=1">공지사항</a> <!-- 공지사항페이지랑 연결 -->
              <ul class="submenu">
                <li><a href="boardList.html?categoryId=1">도미노뉴스</a></li>
                <li><a href="boardList.html?categoryId=2">보도자료</a></li>
              </ul>
            </li>
          </ul>
        </nav>
      </div>
    </header>
    <main>
        <main class="content">
            <p class="join-title">회원가입</p>
            <form id="join_form" class="form">
                <div class="form_content">
                    <div class="form_section">
                        <div class="form_list">
                            <label for="userId">아이디</label>
                            <input type="text" id="userId" name="userId">
    
                            <label for="password">비밀번호</label>
                            <input type="password" id="password" name="password">
    
                            <label for="passwordCheck">비밀번호 확인</label>
                            <input type="password" id="passwordCheck" name="passwordCheck">
    
                            <label for="name">이름</label>
                            <input type="text" id="name" name="name">
    
                            <label for="birthDate">생년월일</label>
                            <input type="text" id="birthDate" name="birthDate" placeholder="YYYYMMDD">
    
                            <label for="email">이메일</label>
                            <input type="email" id="email" name="email" placeholder="dream@example.com">
    
                            <label for="phone">휴대폰 번호</label>
                            <input type="text" id="phone" name="phone" placeholder="010-xxxx-xxxx">
    
                            <label>성별</label>
                            <div class="gender">
                                <input type="radio" id="male" name="gender" value="male" checked>
                                <label for="male">남자</label>
                                <input type="radio" id="female" name="gender" value="female">
                                <label for="female">여자</label>
                            </div>
    
                            <label for="job">직업</label>
                            <select id="job" name="job">
                                <option value="">직업을 선택하세요</option>
                                <option value="developer">개발자</option>
                                <option value="designer">디자이너</option>
                                <option value="manager">매니저</option>
                                <option value="teacher">교사</option>
                                <option value="student">학생</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="btn_submit_wrap" id="divBtnJoin">
                    <button type="submit" class="btn_submit" id="btnJoin">가입하기</button>
                </div>
            </form>
        </main>
    </main>
    <!-- footer -->
    <footer>
        <div class="bottom"> <!--bottom: 하단메뉴 + Copyright-->
      <div class="btm_logo">
        <img src="images/logo.png" alt="로고">
        <p>1577-3082</p>
      </div>
      <div class="btmenu">
        <ul>
          <li><a href="#">이용약관</a></li> 
          <li><a href="#"><b>개인정보 처리방침</b></a></li> 
          <li><a href="#"><b>위치기반 서비스</b></a></li> 
          <li><a href="#">청소년 보호방침</a></li> 
          <li><a href="#">영상정보처리기기 운영관리방침</a></li> 
          <li><a href="#">고객센터</a></li> 
          <li><a href="#">인재채용</a></li>
        </ul>
      </div>
      <div class="copy">
        <p>06223 서울특별시 강남구 역삼로 25길 35(역삼동,청오큐브타워) 청오디피케이㈜ ㅣ 대표이사:오광현,김영훈</p>
        <p>사업자 등록번호:220-81-03371 ㅣ 통신판매업신고:강남 5064호 ㅣ 개인정보 보호책임자:윤여진 ㅣ 민원 책임자:임영길</p>
        <p>문의:webmaster@dominos.co.kr</p>
        <p>COPYRIGHTⓒ Domino's Pizza. ALL RIGHTS RESERVED</p>
        <p>청오디피케이㈜의 사전 서면동의 없이 도미노피자 사이트(PC, 모바일, 앱)의 일체의 정보, 콘텐츠 및 UI 등을 상업적 목적으로 전재, 전송, 스크래핑 등 무단 사용할 수 없습니다.<br>
          도미노피자에서 판매되는 모든 상품은 청오디피케이㈜에서 책임지고 있습니다.</p>
      </div>
    </div>
</footer>
    <script>
        $(document).ready(function() {
            $('#join_form').on('submit', function(event) {
                event.preventDefault(); // 기본 제출 동작을 방지

                // 정규 표현식 패턴
                const userIdPattern = /^[a-zA-Z][a-zA-Z0-9]{4,9}$/; // 시작은 영문자중 하나, 그 뒤에는 영문자 또는 숫자로 4자~9자 사이로 입력, 총 5~10자 사이여야 함.
                const passwordPattern = /^[a-zA-Z](?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[\W_]).{4,12}$/; // 비밀번호는 영문자로 시작하고, 5자 이상 13자 이하이어야 하며, 숫자, 소문자, 대문자, 특수 문자를 최소 하나씩 포함해야 합니다.

                const namePattern = /^[가-힣]{2,5}$/;
                const emailPattern = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;
                const phonePattern = /^010-\d{4}-\d{4}$/;
                const birthDatePattern = /^\d{8}$/;

                // 각 필드에서 값을 가져오기
                var userId = $('#userId').val();
                var password = $('#password').val();
                var passwordCheck = $('#passwordCheck').val();
                var name = $('#name').val();
                var birthDate = $('#birthDate').val();
                var email = $('#email').val();
                var phone = $('#phone').val();
                var gender = $('input[name="gender"]:checked').val();
                // var job = $('#job').val();

                // 아이디 검증
                if (!userIdPattern.test(userId)) {
                    alert('아이디는 영문자로 시작하고, 5자 이상 10자 이하의 영문자 또는 숫자여야 합니다.');
                    $('#userId').focus();
                    return;
                }

                // 비밀번호 검증
                if (!passwordPattern.test(password) || password !== passwordCheck) {
                    alert('비밀번호는 영문자로 시작하고, 5자 이상 13자 이하이어야 하며, 숫자, 소문자, 대문자, 특수 문자를 최소 하나씩 포함해야 합니다.');
                    $('#password').focus();
                    return;
                }

                // 이름 검증
                if (!namePattern.test(name)) {
                    alert('이름은 한글로 2자 이상 5자 이하이어야 합니다.');
                    $('#name').focus();
                    return;
                }

                // 생년월일 검증
                if (!birthDatePattern.test(birthDate)) {
                    alert('생년월일은 YYYYMMDD 형식으로 입력해야 합니다.');
                    $('#birthDate').focus();
                    return;
                }

                // 이메일 검증
                if (!emailPattern.test(email)) {
                    alert('이메일 형식이 올바르지 않습니다.');
                    $('#email').focus();
                    return;
                }

                // 휴대폰 번호 검증
                if (!phonePattern.test(phone)) {
                    alert('휴대폰 번호 형식이 올바르지 않습니다. 010-xxxx-xxxx 형식으로 입력하세요');
                    $('#phone').focus();
                    return;
                }

                // 성별 검증
                if (!gender) {
                    alert('성별을 선택해주세요.');
                    return;
                }

                // 직업 검증
                if (!job) {
                    alert('직업을 선택해주세요.');
                    $('#job').focus();
                    return;
                }

                // 모든 검증이 통과되면 사용자 데이터 저장
                var userData = {
                    userId: userId,
                    password: password,
                    name: name,
                    birthDate: birthDate,
                    email: email,
                    phone: phone,
                    gender: gender,
                    job: job,
                    roleId: 1   // 기본 권한은 1로 설정('USER' - 일반 사용자)
                };

                // 로컬스토리지에 사용자 데이터 배열을 저장, 이미 저정된 데이터가 있으면 가져오고 없으면 빈 배열을 생성
                // || 연산자는 앞의 값이 true이면 그 값을 취하고 false이면 || 뒤의 값을 취한다.
                var users = JSON.parse(localStorage.getItem('users')) || [];
                users.push(userData);
                localStorage.setItem('users', JSON.stringify(users));
                alert('회원 정보가 성공적으로 저장되었습니다.');

                // 회원가입 성공후 로그인 페이지로 이동
                window.location.href = 'login.html';
            });
        });
    </script>

</body>
</html>
